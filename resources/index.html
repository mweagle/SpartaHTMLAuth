<!DOCTYPE HTML>
<!--
	Spatial by TEMPLATED
	templated.co @templatedco
	Released for free under the Creative Commons Attribution 3.0 license (templated.co/license)
-->
<html>

<head>
	<title>Sparta Serverless HTML Website</title>
	<!-- Scripts -->
	<script src="assets/js/jquery.min.js"></script>
	<script src="assets/js/skel.min.js"></script>
	<script src="assets/js/util.js"></script>
	<script src="assets/js/main.js"></script>

	<!-- Highlights -->
	<script src="assets/highlights/highlight.pack.js"></script>
	<link href="assets/highlights/styles/vs.css" rel="stylesheet">
	<script>
		hljs.initHighlightingOnLoad();
	</script>

	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1" />
	<link rel="stylesheet" href="assets/css/main.css" />
	<link rel="icon" href="favicon.ico">

	<script type="text/javascript">
		var corsURL = null;
		$(document).ready(function () {
			$("#corsResponseDiv").hide();

			try {
				$.getJSON("MANIFEST.json", function (data) {
					console.log('MANIFEST.json data: ' + JSON.stringify(data))

					var spartaInfo = JSON.stringify(data, null, ' ');
					$("#spartaCode").text(spartaInfo);
					corsURL = data.APIGatewayURL.Value + "/hello";
					$("#corsURL").attr("placeholder", corsURL);
					$("#corsFormGroup").hide();
				});
			} catch (e) {
				console.error(e.toString());
			}
		});

		var corsRequest = function () {
			function setHeader(xhr) {
				xhr.setRequestHeader('Authorization', 'Sparta');
			}

			$("#corsResponseDiv").hide();
			var updateResponseBlock = function (title, data) {
				$("#corsResponseDiv").show();
				$("#corsResponseTitle").text(title);
				$("#corsResponseBody").text(JSON.stringify(data, null, ' '));
				$('pre code').each(function (i, block) {
					hljs.highlightBlock(block);
				});
			}
			var start = new Date().getTime();
			$.ajax({
				url: corsURL,
				type: 'GET',
				beforeSend: setHeader,
				success: function (data) {
					var end = new Date().getTime();
					var duration = end - start;
					updateResponseBlock("Success (" + duration + " ms)", data);
				},
				error: function (err) {
					var end = new Date().getTime();
					var duration = end - start;
					updateResponseBlock("Error (" + duration + " ms)", err);
				}
			});

			return false;
		}
	</script>
</head>

<body class="landing">

	<!-- Header -->
	<header id="header" class="alt">
		<h1>
			<strong>
				<a href="index.html">Sparta</a>
			</strong>
		</h1>
		<nav id="nav">
			<ul>
				<li>
					<a target="_blank" href="http://gosparta.io">Documentation</a>
				</li>
				<li>
					<a target="_blank" href="https://github.com/mweagle/Sparta">GitHub</a>
				</li>
			</ul>
		</nav>
	</header>

	<a href="#menu" class="navPanelToggle">
		<span class="fa fa-bars"></span>
	</a>

	<!-- Banner -->
	<section id="banner">
		<h2>Congratulations!</h2>
		<p>You have successfully provisioned an S3-backed
			<br /> website with a CORS-enabled API Gateway route targeting
			<br /> a Go lambda function</p>
		<ul class="actions">
			<li>
				<a href="#main" class="button special big">Get Started</a>
			</li>
		</ul>
	</section>

	<!-- Main -->
	<section id="main" class="wrapper">
		<div class="container">
			<!-- Text -->
			<section>
				<header>
					<h3>Make a CORS request to your Lambda function</h3>
				</header>
				<p>The API Gateway resource supports
					<a href="http://docs.aws.amazon.com/apigateway/latest/developerguide/how-to-cors.html">CORS headers</a> which permit successful Ajax requests. Sparta includes
					discovery information in the form of a <i>MANIFEST.json</i> file to connect your service's API Gateway to the dynamically created S3-backed website. This file is automatically generated
					and included at your website's root:
					<ul>
						<li>
							<a target="_blank" href="MANIFEST.json">MANIFEST.json</a>
						</li>
					</ul>
					The <i>MANIFEST.json</i> document links the website to the API Gateway REST API and ultimately to your Go AWS Lambda function.
					<br />
					<br />
					<a href="#" onclick="javascript:corsRequest(); return false" class="button special small">Try It!</a>
				</p>
				<hr />

				<div id="corsResponseDiv">
					<h4 id="corsResponseTitle"></h4>
					<pre>
						<code class="json" id="corsResponseBody"></code>
					</pre>
				</div>
			</section>

			<!-- Lists -->
			<section>
					<h6>Credits</h6>
					<div class="row">
							<div class="6u 12u$(xsmall)">
								<ul>
									<li><a target="_blank" href="https://templated.co/spatial">Spatial HTML Template</a></li>
									<li><a target="_blank" href="https://unsplash.com/photos/iMxsCt2rxAQ">Joseph Chan - Photographer</a></li>
								</ul>
							</div>
					</div>
			</section>
</body>

</html>